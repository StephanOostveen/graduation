\section{State-of-the-art analysis}
\label{sec:sota}
An overview of the state-of-the-art research in Time Sensitive Networking (TSN) for automotive systems together with open challenges is presented in~\cite{ashjaei2021time}. It suggests the following TSN features to be implemented in new automotive networks: accurate and reliable clock synchronization (IEEE 802.1 AS) for a global, accurate and synchronized timebase, bounded latency for real-time traffic (IEEE 802.1Qav), reservation of resources for different traffic types (IEEE 802.1Qcc). To reduce jitter and achieve temporal isolation, which is necessary to achieve constructive composability as defined by~\cite{kopetz2003time}, scheduled traffic (IEEE 802.1Qbv) is needed. The work finally remarks that the Asynchronous Traffic Shaper (IEEE 802.1Qcr) is promising as it allows mixing real-time traffic types (periodic, sporadic and aperiodic) with integrated policing increasing robustness, but more research is necessary. We start by investigating the available analysis techniques for various TSN standards and configurations, followed by an overview of methods for generating schedules (Gate Control Lists) for the Time Aware Shaper (IEEE 802.1Qbv) and finally investigate the availability of models for the simulation of TSN networks.

\paragraph{Analysis}
As one of the main goals of TSN is to provide deterministic transmission latency it starts to be used in time-critical systems. During the design of real-time systems it is natural to perform schedulability analysis and verify the timing requirements are met. The Credit Based Shaper (CBS), IEEE 802.1Qav, was the first traffic shaper to be designed and standardized in 2009. As a result various schedulability analysis techniques have been developed. For example~\cite{de2014complete} uses Network Calculus to compute bounds on the worst case delay for the real time classes A and B. Computing bounds on the worst case end-to-end delay for sporadic flows sent using the classes A and B is possible using the method presented in~\cite{li2017deterministic}. Both lack the ability to calculate a worst cased delay on a specific message or periodic stream. A bound on the per frame delay can be calculated using the method presented in~\cite{cao2016independent}. 

An analysis method for computing a bound on the worst case end-to-end delay for frames from Time Aware Shaper (TAS) streams and non-TAS streams is presented in~\cite{thiele2015formal}. It assumes that all streams of a certain class have the same time interval in which they can be transmitted on a certain link. It also assumes the interval to be periodic. These assumptions are more restrictive than the TAS (IEEE 802.1Qbv) standard, which is not necessarily an issue for an automotive use-case as many applications produce and consume periodic data streams. The work in \cite{zhao2018timing} presents a schedulability analysis for CBS streams in a TAS network. Namely, the time slots for the TAS traffic, the guard bands and preemption overhead have effect on the QoS of CBS streams. The method proofs that the CBS credit does not overflow a certain threshold, concluding that the CBS streams are schedulable. A method for calculating the worst case delay a critical flow can experience at the output ports along the hops is presented in~\cite{zhao2018worst}. It allows gates of different queues to be opened at the same time and different flows are allowed to merge in the same queue. This method can be used to verify the real-time properties of a system, but can also be used in the optimization of the Gate Control Lists.

Regarding the preemption model introduced by IEEE 802.3br and IEEE 802.1Qbu some works~\cite{thiele2016formal},\cite{bello2020schedulability} have proposed analysis techniques, where the latter performed an evaluation of the technique compared to a simulation using the \omnet framework. But ~\cite{ashjaei2021time} mentions that more research is necessary to reduce pessimism in the schedulability analysis techniques of preemption together with TAS and CBS. Especially because~\cite{ashjaei2021novel} discovered a limitation in the frame preemption model presented in the TSN standard and used by the previously mentioned works. In their paper~\cite{ashjaei2021novel} a new model is proposed that is compatible with the TSN standards but allows a 90\% reduction in the maximum blocking delay compared to the original model. Through simulation using \omnet it is shown that the reduction is very significant when used in a multi-switch TSN network.

\paragraph{Schedule generation}
Time-triggered communication is a popular method in real-time systems as they have strict requirements on jitter and delay. Time-triggered communication makes the analysis of such systems easier, allows subsystems to be developed and tested separately while being sure that combining the subsystems together will not influence subsystems' temporal properties~\cite{kopetz2003time}. Examples of communication protocols using time-triggered communication are LIN, TTP, TTEthernet and IEEE 802.1 Qbv (Time Aware Shaper). The communication is divided into time-slots in which (often) only one message is scheduled for transmission. Scheduling the time-slots happens at design-time, the resulting schedule is static and must be obeyed by every node in the network. Global schedule synthesis for time-triggered networks is known to be NP-complete~\cite{steiner2010evaluation}.

In the context of TTEthernet a solution based on Satisfiability Modulo Theories (SMT) was created~\cite{steiner2010evaluation}. The solution encodes a set of scheduling, timing and routing constraints and uses an SMT solver to find a schedule for an Ethernet based multi-hop switched network. This work was later extended~\cite{craciunas2016combined} to combine the creation of task schedules for a preemptive scheduler and the schedule for frames on the switched multi-hop network. Additionally, optimization objectives for SMT and Mixed Integer Programming (MIP) solvers are presented which allow the generation of an optimal schedule. To finish an incremental algorithm is presented that improves the average case runtime of the combined scheduling problem without compromising the schedulability. Since TTEthernet has certain similarities with the IEEE 802.1Qbv Time Aware Shaper several works have taken the same approach to generating (optimized) schedules for TSN networks. Different groups have created scheduling methods that optimize a large array of metrics. For example, \cite{craciunas2016scheduling} presents a method for finding a schedule while minimizing the total number of required queues in the switches. Optimizing the Quality of Service for best-effort traffic while satisfying the timing constraints of time-triggered traffic was shown in~\cite{houtan2021synthesising}. While other works consider different constraints as well, such as~\cite{gavrilut2017fault} which next to timing constraints also considers redundant transmission across multiple paths to obtain a fault-tolerant network.

\paragraph{Simulation} Because of the complexity of large TSN networks evaluating the performance of a network at design time is difficult. We have seen that analysis methods exist, but they can have limitations due to the assumptions they make on a network topology or configuration or because some underlying model does not fit the desired implementation, as seen in the analysis methods for preemption. Additionally, multiple parameters affect the performance of the network, such as maximum frame size, preemption model, network topology, TAS schedule, etc.~\cite{ashjaei2021time}. For these reasons and more, network simulation has been adopted in the industry and academia to evaluate performance of a design. Common network simulation frameworks such as \omnet and NS3 use a discrete event simulation model as it allows for fast simulation of networks~\cite{ashjaei2021time}. We have seen that \omnet is often used in academia to evaluate the effectiveness of analysis methods such as in~\cite{bello2020schedulability} and \cite{ashjaei2021novel}.

NeSTiNg~\cite{falk2019nesting} is based on the INET library~\cite{meszaros2019inet} that is an extension of \omnet. NeSTiNg adds models for the Credit Based Shaper, the Time Aware Shaper, frame preemption. It is lacking an implementation of the timing and clock synchronization standard (IEEE 802.1AS), timing is rather implemented using switch local clocks. Frame replication and elimination for redundancy (IEEE 802.1CB) is also not implemented by NeSTiNg. An extension was presented~\cite{houtan2021automated} which automates the generation of configuration files for the NeSTiNg framework and improves the use of the framework by adding graphical user interfaces for editing schedules, routing of flows etc.

A different \omnet framework supporting TSN is CoRE4INET~\cite{steinbach2011extension} which is based on the INET library as well. CoRE4INET provides models for TTEthernet, and parts of the AVB/TSN standards such as the CBS, TAS but is also lacking the timing and clock synchronization standard.

Finally, it is worth mentioning that INET was recently updated (15 June 2022) adding support for key features of TSN. Notably support for a subset of the timing and synchronization standard (IEEE 802.1AS) is added. Individual network nodes can keep track of time, and modules implementing the time synchronization protocol have been added. Support for the CBS and TAS is also available as well as frame replication and elimination, and finally frame preemption support is also available.